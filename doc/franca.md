Transpiler FIDL and FDEPL syntax
================================

Transpiler uses [Franca][franca] to define APIs. A full guide on the Franca IDL can be found in the
[franca user guide][userguide].

This file describes additional FIDL and FDEPL syntax used by Transpiler.


FIDL and FDEPL files
--------------------

Interfaces in Franca are described in .fidl files. A class MyGeneratedClass would have an
`interface MyGeneratedClass` in a `MyGeneratedClass.fidl`. Fidl files are meant to describe an
interface and its methods. Any platform-, language- or otherwise specific information that needs to
be defined should be defined in an accompanying .fdepl file. In this case it would be in a
`MyGeneratedClass.fdepl` file.

**Note:** Chapter five and six in the [user guide][userguide] describes in detail the syntax of the
.fidl and .fdepl files, something that is beyond the scope of this document.


Custom FIDL syntax
------------------

### Instance reference

Transpiler extends the concept of Franca interface by allowing creation of instances of those
interfaces. There is a special FIDL syntax that makes referencing such interfaces possible (e.g. as
struct field types, method parameters types, etc.).

An "instantiable" interface should have a `typedef` with the same name as the interface itself, and
the typedef should point to `undefinied` type:

    interface ExampleInstance {
        typedef ExampleInstance is undefined
    }

When referencing such interface elsewhere, the full name would be the name of the interface,
followed by a period and then the same name again:

    interface AnotherInterface {
        method doSomething {
            in {
                ExampleInstance.ExampleInstance instanceReference
            }
        }
    }

Custom FDEPL syntax
-------------------

### Interface: IsInterface

This FDEPL property controls whether the given Franca interface is represented with a class
in generated Java/Swift code or with an interface/protocol. Default value is `false`, i.e. classes
are generated by default. This property has no effect on generated C++ headers.

FIDL:

    package example

    interface ExampleInterface {
    }

FDEPL:

    define navigation.BaseApiSpec for interface example.ExampleInterface
    {
        IsInterface = true
    }

### Method: Const

This FDEPL property controls whether the given Franca method is generated with a `const`
specifier in C++. Default value is `false`, i.e. no `const` specifier is generated. This property
has no effect on generated code for Java or Swift.

FIDL:

    package example

    interface ExampleInterface {
        method exampleMethod {
        }
    }

FDEPL:

    define navigation.BaseApiSpec for interface example.ExampleInterface
    {
        method exampleMethod {
            Const = true
        }
    }

### Method: Static

This FDEPL property controls whether the given Franca method is generated as `static` in all
supported languages. Default value is `false`, i.e. an instance method is generated.

**Note:** Static methods are not supported if `IsInterface` property is set to `true`.

FIDL:

    package example

    interface ExampleInterface {
        method exampleMethod {
        }
    }

FDEPL:

    define navigation.BaseApiSpec for interface example.ExampleInterface
    {
        method exampleMethod {
            Static = true
        }
    }

### Struct: Serializable

This FDEPL property controls whether any serialization infrastructure is generated for the
given Franca struct. Default value is `false`, i.e. no serialization infrastructure is generated.
Currently the only serialization type supported is `android.os.Parcelable` for generated Java code.
This property currently has no effect on generated code for C++ or Swift.

FIDL:

    package example

    typeCollection ExampleTypeCollection {
        struct exampleStruct {
        }
    }

FDEPL:

    define navigation.BaseApiSpec for typeCollection example.ExampleTypeCollection
    {
        struct exampleStruct {
            Serializable = true
        }
    }

### Struct field: DefaultValue

This FDEPL property controls whether a default value initializer is generated for the given
field in the given Franca struct. Default value is `null`, i.e. no default value initializer is
generated.

**Note:** The type of this property in the FDEPL file is always `String` regardless of the actual
type of the struct field. The given string value is converted to represent a value of the correct
type in the generated code.

FIDL:

    package example

    typeCollection ExampleTypeCollection {
        struct exampleStruct {
            Float floatField
            String stringField
        }
    }

FDEPL:

    define Defaults for typeCollection example.ExampleTypeCollection
    {
        struct exampleStruct {
            floatField {
                DefaultValue = "3.14"
            }
            stringField {
                DefaultValue = "some string"
            }
        }
    }


[franca]: http://franca.github.io/franca/
[userguide]: https://drive.google.com/file/d/0B7JseVbR6jvhMXhNb1VMRWM0Z3M/view?usp=sharing
